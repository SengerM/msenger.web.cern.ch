<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>statistics &#8211; e a la i por pi</title>
	<atom:link href="https://msenger.web.cern.ch/tag/statistics/feed/" rel="self" type="application/rss+xml" />
	<link>https://msenger.web.cern.ch</link>
	<description></description>
	<lastBuildDate>Tue, 25 Jan 2022 23:24:25 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=6.4.3</generator>

<image>
	<url>https://msenger.web.cern.ch/wp-content/uploads/2020/12/e-a-la-i-por-pi-1.svg</url>
	<title>statistics &#8211; e a la i por pi</title>
	<link>https://msenger.web.cern.ch</link>
	<width>32</width>
	<height>32</height>
</image> 
	<item>
		<title>Robust statistics</title>
		<link>https://msenger.web.cern.ch/robust-statistics/</link>
		
		<dc:creator><![CDATA[Matías Senger]]></dc:creator>
		<pubDate>Sun, 23 Jan 2022 15:13:13 +0000</pubDate>
				<category><![CDATA[Uncategorized]]></category>
		<category><![CDATA[statistics]]></category>
		<guid isPermaLink="false">https://msenger.web.cern.ch/?p=824</guid>

					<description><![CDATA[Introduction One of the most common tasks when analyzing data from the lab is to estimate the mean and standard deviation of some set of samples, usually with a Gaussian distribution. This is very straightforward nowadays, we just ask to the computer to compute these quantities and that&#8217;s it. And when the samples come from &#8230;<p class="read-more"> <a class="" href="https://msenger.web.cern.ch/robust-statistics/"> <span class="screen-reader-text">Robust statistics</span> Read More &#187;</a></p>]]></description>
										<content:encoded><![CDATA[


<h2 class="wp-block-heading">Introduction</h2>



<p>One of the most common tasks when analyzing data from the lab is to estimate the mean and standard deviation of some set of samples, usually with a Gaussian distribution. This is very straightforward nowadays, we just ask to the computer to compute these quantities and that&#8217;s it. And when the samples come from a Gaussian distribution we are estimating µ and σ respectively. That sounds easy. </p>



<p>Recently, however, I came across the problem of dealing with outliers, i.e. samples that are definitely wrong. For example in the list of numbers <code>[1,2,3,4,5,6,99]</code> there is clearly one outlier<span class="footnote_referrer"><a role="button" tabindex="0" onclick="footnote_moveToReference_824_2('footnote_plugin_reference_824_2_1');" onkeypress="footnote_moveToReference_824_2('footnote_plugin_reference_824_2_1');" ><sup id="footnote_plugin_tooltip_824_2_1" class="footnote_plugin_tooltip_text">[1]</sup></a><span id="footnote_plugin_tooltip_text_824_2_1" class="footnote_tooltip">The <code>99</code>, in case you didn&#8217;t noticed it.</span></span><script type="text/javascript"> jQuery('#footnote_plugin_tooltip_824_2_1').tooltip({ tip: '#footnote_plugin_tooltip_text_824_2_1', tipClass: 'footnote_tooltip', effect: 'fade', predelay: 0, fadeInSpeed: 200, delay: 400, fadeOutSpeed: 200, position: 'top center', relative: true, offset: [-7, 0], });</script> which we can remove by hand and then analyze the rest of the numbers. These outliers are usually very easy to spot and remove, but we don&#8217;t want to do this &#8220;by hand&#8221;, or by hardcoding a cut in our data analysis program. There has to be something better&#8230; And there is!</p>



<p>If we are dealing with a symmetric distribution, which is very often the case, we can replace the <a href="https://en.wikipedia.org/wiki/Mean" data-type="URL" data-id="https://en.wikipedia.org/wiki/Mean">mean</a> by the <a href="https://de.wikipedia.org/wiki/Median" data-type="URL" data-id="https://de.wikipedia.org/wiki/Median">median</a>. This, I think, is a very well known trick. The median will provide a number close to the mean but is much more robust against outliers. Note that this works only for symmetric distributions.</p>



<p>What about the <a href="https://en.wikipedia.org/wiki/Standard_deviation" data-type="URL" data-id="https://en.wikipedia.org/wiki/Standard_deviation">standard deviation</a>? I recently came across the <a href="https://en.wikipedia.org/wiki/Median_absolute_deviation" data-type="URL" data-id="https://en.wikipedia.org/wiki/Median_absolute_deviation">median absolute deviation</a> that provides a measure of the variability of a set of samples (in the same way as the standard deviation) but is way more robust against outliers than the former. Of course it is a different quantity, so we wont expect it will converge to the same value as the standard deviation. But under certain conditions, common in practice, they are related by an easy equation. Specifically, in the case of a set of samples from a <strong>Gaussian distribution</strong> it they relate by<span class="footnote_referrer"><a role="button" tabindex="0" onclick="footnote_moveToReference_824_2('footnote_plugin_reference_824_2_2');" onkeypress="footnote_moveToReference_824_2('footnote_plugin_reference_824_2_2');" ><sup id="footnote_plugin_tooltip_824_2_2" class="footnote_plugin_tooltip_text">[2]</sup></a><span id="footnote_plugin_tooltip_text_824_2_2" class="footnote_tooltip">See <a href="https://en.wikipedia.org/wiki/Median_absolute_deviation#Relation_to_standard_deviation" data-type="URL" data-id="https://en.wikipedia.org/wiki/Median_absolute_deviation#Relation_to_standard_deviation">here</a>.</span></span><script type="text/javascript"> jQuery('#footnote_plugin_tooltip_824_2_2').tooltip({ tip: '#footnote_plugin_tooltip_text_824_2_2', tipClass: 'footnote_tooltip', effect: 'fade', predelay: 0, fadeInSpeed: 200, delay: 400, fadeOutSpeed: 200, position: 'top center', relative: true, offset: [-7, 0], });</script></p>



<div class="wp-block-mathml-mathmlblock">\[\text{STD} \sim k \times \text{MAD}\]<script src="https://msenger.web.cern.ch/wp-includes/js/dist/vendor/wp-polyfill-inert.min.js?ver=3.1.2" id="wp-polyfill-inert-js"></script>
<script src="https://msenger.web.cern.ch/wp-includes/js/dist/vendor/regenerator-runtime.min.js?ver=0.14.0" id="regenerator-runtime-js"></script>
<script src="https://msenger.web.cern.ch/wp-includes/js/dist/vendor/wp-polyfill.min.js?ver=3.15.0" id="wp-polyfill-js"></script>
<script src="https://msenger.web.cern.ch/wp-includes/js/dist/hooks.min.js?ver=c6aec9a8d4e5a5d543a1" id="wp-hooks-js"></script>
<script src="https://msenger.web.cern.ch/wp-includes/js/dist/i18n.min.js?ver=7701b0c3857f914212ef" id="wp-i18n-js"></script>
<script id="wp-i18n-js-after">
wp.i18n.setLocaleData( { 'text direction\u0004ltr': [ 'ltr' ] } );
</script>
<script  async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML" id="mathjax-js"></script>
</div>



<p>where \(k\approx1.4826\), which is really useful.</p>



<p>There is a third method usually employed to get the µ and the σ from sampled data that consists in fitting a Gaussian function to the histogram, I will also study this method today.</p>



<p>To summarize, today I will be comparing</p>



<ol><li>Comparison of estimators of µ:<ul><li>Mean (the usual estimator).</li><li>Median (the robust estimator).</li><li>µ from a Gaussian fit to the histogram (the sophisticated estimator).</li></ul></li><li>Comparison of estimators of σ:<ul><li>Standard deviation (std) (the usual estimator).</li><li>Median absolute deviation (MAD) multiplied by k (the robust estimator).</li><li>σ from a Gaussian fit to the histogram (the sophisticated estimator).</li></ul></li></ol>



<h2 class="wp-block-heading">When there are a lot of samples and no outliers</h2>



<p>I will first compare what happens when we are in a favorable condition with a lot of samples and no outliers, i.e. the &#8220;happy scenario&#8221;. The following plot is a histogram of a single set of 9999 samples from a Gaussian distribution with µ=0 and σ=1. On the same plot I have indicated the different statistics I am interested in, namely the mean, the median, the std, the median absolute deviation (MAD) and a Gaussian function fitted to the histogram. </p>



<iframe style="width: 100%; height: 444px; min-width: 666px; max-width: 888px;" src="https://msenger.web.cern.ch/wp-content/uploads/2022/01/A-9999-samples-no-outliers-Single-experiment-example.html"></iframe>



<p>This is the ideal case: a lot of samples without outliers, so things will work as expected. Under these conditions the distribution of each statistic itself is shown in the following two plots:</p>



<div style="display: flex; max-width: 999px;">

<iframe style="width: 50%; height: 444px; min-width: 444px; max-width: 888px;" src="https://msenger.web.cern.ch/wp-content/uploads/2022/01/A-9999-samples-no-outliers-Estimating-mu.html"></iframe>

<iframe style="width: 50%; height: 444px; min-width: 444px; max-width: 888px;" src="https://msenger.web.cern.ch/wp-content/uploads/2022/01/A-9999-samples-no-outliers-Estimating-sigma.html"></iframe>

</div>



<p>For µ we can see that the three estimators are practically the same, maybe the mean is slightly better than the other two. For σ we see that std is slightly better than the other two, and the other two behave practically the in the same way. So in &#8220;the happy scenario&#8221; we can (of course) trust in the mean and the std estimators. We all knew this.</p>



<h2 class="wp-block-heading">A lot of samples but with outliers</h2>



<h3 class="wp-block-heading">A single outlier</h3>



<p>How do things change if we keep all the same but add a single outlier? Now I repeated the same procedure but using 9998 samples from a normal distribution and in the sample number 9999 I forced manually an outlier with a value of 99. So this is still a &#8220;very good scenario&#8221; in which we have 9999 samples with just a single outlier which is very easy to spot.</p>



<p>One single example of such a distribution is this:</p>



<iframe style="width: 100%; height: 444px; min-width: 666px; max-width: 888px;" src="https://msenger.web.cern.ch/wp-content/uploads/2022/01/B-9999-samples-1-outlier-Single-experiment-example.html"></iframe>



<p>Zooming into the interesting region we already notice something: the standard deviation is not what we expect, due to the outlier. The distribution of each of the statistics themselves is shown below:</p>



<div style="display: flex; max-width: 999px;">

<iframe style="width: 50%; height: 444px; min-width: 444px; max-width: 888px;" src="https://msenger.web.cern.ch/wp-content/uploads/2022/01/B-9999-samples-1-outlier-Estimating-mu.html"></iframe>

<iframe style="width: 50%; height: 444px; min-width: 444px; max-width: 888px;" src="https://msenger.web.cern.ch/wp-content/uploads/2022/01/B-9999-samples-1-outlier-Estimating-sigma.html"></iframe>

</div>



<p>Here we see something interesting and is that the standard deviation is completely wrong. You will say if 0.4 is too much or it is acceptable. But one single outlier in a population of 9999 samples (this is 0.01 % of the data) was enough to break it. The other two estimators of σ remain unchanged, which is good. With respect to µ we see that the mean was also affected but not so much.</p>



<h3 class="wp-block-heading">Several outliers</h3>



<p>Let&#8217;s get more severe now and multiply the last 99 samples by 99, thus producing 99 outliers. So now our population has 9900 &#8220;good samples&#8221; and 99 outliers, this represents 1% of corrupted data. It is still a decent situation and, more important to me, <em>one that I am finding quite often in the lab</em>. </p>



<p>One example of such a distribution is shown below:</p>



<iframe style="width: 100%; height: 444px; min-width: 666px; max-width: 888px;" src="https://msenger.web.cern.ch/wp-content/uploads/2022/01/C-9999-samples-99-outliers-Single-experiment-example.html"></iframe>



<p>If a human were to analyze such distribution he/she could easily spot the Gaussian in the middle (feel free to zoom in the plot by drag and drop with your mouse) and conclude that the population comes from a normal distribution with some outliers. We see, however, that the standard deviation is, again, failing at this, with a value ~10 times bigger than expected<span class="footnote_referrer"><a role="button" tabindex="0" onclick="footnote_moveToReference_824_2('footnote_plugin_reference_824_2_3');" onkeypress="footnote_moveToReference_824_2('footnote_plugin_reference_824_2_3');" ><sup id="footnote_plugin_tooltip_824_2_3" class="footnote_plugin_tooltip_text">[3]</sup></a><span id="footnote_plugin_tooltip_text_824_2_3" class="footnote_tooltip">Well, the standard deviation is properly doing its job, what is wrong here is that there are outliers&#8230;</span></span><script type="text/javascript"> jQuery('#footnote_plugin_tooltip_824_2_3').tooltip({ tip: '#footnote_plugin_tooltip_text_824_2_3', tipClass: 'footnote_tooltip', effect: 'fade', predelay: 0, fadeInSpeed: 200, delay: 400, fadeOutSpeed: 200, position: 'top center', relative: true, offset: [-7, 0], });</script>. If we look at the distribution of each of the statistics we are studying we get this:</p>



<div style="display: flex; max-width: 999px;">

<iframe style="width: 50%; height: 444px; min-width: 444px; max-width: 888px;" src="https://msenger.web.cern.ch/wp-content/uploads/2022/01/C-9999-samples-99-outliers-Estimating-mu.html"></iframe>

<iframe style="width: 50%; height: 444px; min-width: 444px; max-width: 888px;" src="https://msenger.web.cern.ch/wp-content/uploads/2022/01/C-9999-samples-99-outliers-Estimating-sigma.html"></iframe>

</div>



<p>It is evident (right plot) that the standard deviation is failing to tell us the value of σyet but the MAD is still working! (please zoom in to see this) It is only slightly shifted to 1.01 instead of 1. Impressive. The Gaussian fit to the histogram itself is still intact, so it is the most robust method under these conditions. In the case of the mean, we don&#8217;t expect it to be shifted because the outliers are symmetric with respect to the the µ of the original Gaussian, however we see that it spreads much more. The median and the Gaussian fit, instead, still remain intact.</p>



<h2 class="wp-block-heading">Few samples without outliers </h2>



<p>The last case I want to analyze is that with few samples and no outliers. So this is &#8220;a good measurement but with low statistics&#8221;. <em>Can we still rely on the median, the MAD and the Gaussian fit?</em></p>



<p>So now I repeat exactly the same but with a set of 44 samples from a normal distribution. One of such experiments with 44 samples looks like this:</p>



<iframe style="width: 100%; height: 444px; min-width: 666px; max-width: 888px;" src="https://msenger.web.cern.ch/wp-content/uploads/2022/01/D-44-samples-no-outliers-Single-experiment-example.html"></iframe>



<p>I bet that many humans will have a hard time looking at the histogram and trying to tell whether these samples are coming from a Gaussian or not. Anyway, if we look at how each of the statistics perform in these conditions we get this:</p>



<div style="display: flex; max-width: 999px;">

<iframe style="width: 50%; height: 444px; min-width: 444px; max-width: 888px;" src="https://msenger.web.cern.ch/wp-content/uploads/2022/01/D-44-samples-no-outliers-Estimating-mu.html"></iframe>

<iframe style="width: 50%; height: 444px; min-width: 444px; max-width: 888px;" src="https://msenger.web.cern.ch/wp-content/uploads/2022/01/D-44-samples-no-outliers-Estimating-sigma.html"></iframe>

</div>



<p>Here again we see a surprise: if we don&#8217;t zoom in horizontally we cannot tell what is going on&#8230; So please zoom in horizontally before reading more, you can do this by click and drag with your mouse horizontally&#8230; If you did zoom in, you already know what is going on: the mean, the median, the std and the MAD are all working good but the Gaussian fit has this time produced some outliers. The reason for this is that we have so little statistics that the histogram is hardly recognizable as coming from a Gaussian, and the fit is trying to fit a Gaussian to it, so it is prompt to fail. It is still a good method, most of the times it works, but if you are unlucky your data may be one of those cases in which the fit either produces one outlier (i.e. it tells you that µ=200, or σ=150, or both) or even worse the fit may not converge (for sets with 44 samples this was happening to me approximately 0.4% of the times). </p>



<h2 class="wp-block-heading">Conclusion</h2>



<p>If dealing with <em>Gaussian distributed data</em>, both the <a href="https://de.wikipedia.org/wiki/Median" data-type="URL" data-id="https://de.wikipedia.org/wiki/Median">median</a> and the <a href="https://en.wikipedia.org/wiki/Median_absolute_deviation" data-type="URL" data-id="https://en.wikipedia.org/wiki/Median_absolute_deviation">median absolute deviation</a> multiplied by 1.4826 are nice alternatives for the mean and the standard deviation when you want to be robust to outliers. They are a workhorse which will provide a good answer practically in any scenario<span class="footnote_referrer"><a role="button" tabindex="0" onclick="footnote_moveToReference_824_2('footnote_plugin_reference_824_2_4');" onkeypress="footnote_moveToReference_824_2('footnote_plugin_reference_824_2_4');" ><sup id="footnote_plugin_tooltip_824_2_4" class="footnote_plugin_tooltip_text">[4]</sup></a><span id="footnote_plugin_tooltip_text_824_2_4" class="footnote_tooltip">when your data is Gaussian!</span></span><script type="text/javascript"> jQuery('#footnote_plugin_tooltip_824_2_4').tooltip({ tip: '#footnote_plugin_tooltip_text_824_2_4', tipClass: 'footnote_tooltip', effect: 'fade', predelay: 0, fadeInSpeed: 200, delay: 400, fadeOutSpeed: 200, position: 'top center', relative: true, offset: [-7, 0], });</script>. A Gaussian fit is also very robust, in fact is the most robust when the data set is big enough. However it requires more effort to be implemented<span class="footnote_referrer"><a role="button" tabindex="0" onclick="footnote_moveToReference_824_2('footnote_plugin_reference_824_2_5');" onkeypress="footnote_moveToReference_824_2('footnote_plugin_reference_824_2_5');" ><sup id="footnote_plugin_tooltip_824_2_5" class="footnote_plugin_tooltip_text">[5]</sup></a><span id="footnote_plugin_tooltip_text_824_2_5" class="footnote_tooltip">i.e. it is more complicated than <code>MAD=scipy.stats.median_abs_deviation(your_data)</code></span></span><script type="text/javascript"> jQuery('#footnote_plugin_tooltip_824_2_5').tooltip({ tip: '#footnote_plugin_tooltip_text_824_2_5', tipClass: 'footnote_tooltip', effect: 'fade', predelay: 0, fadeInSpeed: 200, delay: 400, fadeOutSpeed: 200, position: 'top center', relative: true, offset: [-7, 0], });</script>, and when the dataset is small it is prompt to fail and produce disparate results or even not converging.</p>



<h2 class="wp-block-heading">Appendix: Software</h2>



<p>Just for reference and for the curious reader who wants to explore in more detail, here I left the Python code used to produce the plots:</p>


<div class="wp-block-syntaxhighlighter-code "><pre class="brush: python; title: ; quick-code: false; notranslate">
import numpy as np
import grafica # https://github.com/SengerM/grafica
from scipy.stats import median_abs_deviation
import pandas
from scipy.optimize import curve_fit

MAD_TO_STD_FACTOR = 1.4826 # Constant from Wikipedia.

def gaussian(x, mu, sigma, amplitude=1):
	return amplitude/sigma/(2*np.pi)**.5*np.exp(-((x-mu)/sigma)**2/2)

def fit_gaussian(x_values, y_values):
	popt, pcov = curve_fit(
		gaussian,
		x_values,
		y_values,
		p0 = &#91;np.median(samples),median_abs_deviation(samples)*MAD_TO_STD_FACTOR,max(y_values)],
	)
	return popt&#91;0], popt&#91;1], popt&#91;2]

def draw_center_and_band_lines(plotlyfig, color, y_position, center: float, center_name: str=None, band: float=None, band_name: str=None):
	plotlyfig.add_vline(
		x = center,
		annotation_text = f&#039;{center_name} = {center:.2f}&#039; if center_name is not None else &#039;&#039;,
		line_color = color,
	)
	if band is not None:
		for s in &#91;-band, band]:
			plotlyfig.add_vline(
				x = center + s,
				line_color = color,
				line_dash = &#039;dash&#039;,
			)
		plotlyfig.add_annotation(
			x = center,
			y = y_position,
			ax = center + band,
			ay = y_position,
			yref = &#039;y domain&#039;,
			showarrow = True,
			axref = &quot;x&quot;, ayref=&#039;y&#039;,
			arrowhead = 3,
			arrowwidth = 1.5,
		)
		plotlyfig.add_annotation(
			x = center + band,
			y = y_position,
			ax = center,
			ay = y_position,
			yref = &#039;y domain&#039;,
			showarrow = True,
			axref = &quot;x&quot;, ayref=&#039;y&#039;,
			arrowhead = 3,
			arrowwidth = 1.5,
		)
		plotlyfig.add_annotation(
			text = f&#039;{band_name} = {band:.2f}&#039; if band_name is not None else &#039;&#039;,
			ax = center + band/2,
			ay = y_position+.02,
			x = center + band/2,
			y = y_position+.02,
			yref = &quot;y domain&quot;,
			axref = &quot;x&quot;, ayref=&#039;y&#039;,
		)

def draw_histogram_and_analysis_of_single_experiment(samples, bins):
	fig = grafica.new(
		ylabel = &#039;Count&#039;,
	)
	fig.histogram(
		samples,
		bins = bins,
		label = f&#039;{len(samples)} samples&#039;,
	)
	draw_center_and_band_lines(
		plotlyfig = fig.plotly_figure,
		center = samples.mean(),
		center_name = &#039;Mean&#039;,
		band = samples.std(),
		band_name = &#039;std&#039;,
		color = &#039;black&#039;,
		y_position = .1,
	)
	draw_center_and_band_lines(
		plotlyfig = fig.plotly_figure,
		center = np.median(samples),
		center_name = &#039;Median&#039;,
		band = median_abs_deviation(samples),
		band_name = &#039;MAD&#039;,
		color = &#039;#fcba03&#039;,
		y_position = .4,
	)
	draw_center_and_band_lines(
		plotlyfig = fig.plotly_figure,
		center = np.median(samples),
		band = median_abs_deviation(samples)*MAD_TO_STD_FACTOR,
		band_name = f&#039;MAD*{MAD_TO_STD_FACTOR}&#039;,
		color = &#039;#47a130&#039;,
		y_position = .7,
	)
	return fig

results_df = pandas.DataFrame()
for n_experiment in range(9999): # This is the number of experiments.
	samples = np.random.randn(9999) # Change the number of samples.
	# ~ samples&#91;-99:] *= 99 # Produce outliers with this line.
	samples = np.array(samples)
	# Fit a Gaußian to the histogram ---
	bins = np.linspace(min(samples),max(samples),(max(samples)-min(samples))/.2)
	hist, bins_edges = np.histogram(
		samples, 
		bins = bins,
	)
	x_values = bins_edges&#91;:-1] + np.diff(bins_edges)&#91;0]/2
	y_values = hist
	try:
		fitted_mu, fitted_sigma, fitted_amplitude = fit_gaussian(x_values, y_values)
	except RuntimeError: # This happens when the fit fails because there are very few samples.
		fitted_mu, fitted_sigma, fitted_amplitude = (float(&#039;NaN&#039;),)*3
	results_df = results_df.append(
		{
			&#039;mean&#039;: samples.mean(),
			&#039;std&#039;: samples.std(),
			&#039;MAD&#039;: median_abs_deviation(samples),
			&#039;MAD*k&#039;: median_abs_deviation(samples)*MAD_TO_STD_FACTOR,
			&#039;median&#039;: np.median(samples),
			&#039;mu fit&#039;: fitted_mu,
			&#039;sigma fit&#039;: fitted_sigma,
		},
		ignore_index = True,
	)

print(f&#039;Number of failed Gaussian fits: {results_df&#91;&quot;mu fit&quot;].isna().sum()}&#039;)
fig = draw_histogram_and_analysis_of_single_experiment(samples, bins)
fig.scatter(
	x = x_values,
	y = gaussian(x_values, fitted_mu, fitted_sigma, fitted_amplitude),
	label = f&#039;Fitted Gaußian (μ={fitted_mu:.2f}, σ={fitted_sigma:.2f})&#039;,
)
fig.title = &#039;Single experiment example&#039;

for comparison in &#91;&#039;Estimating mu&#039;,&#039;Estimating sigma&#039;]:
	fig = grafica.new(
		title = comparison,
		ylabel = &#039;Count&#039;,
	)
	for col in (&#91;&#039;mean&#039;,&#039;median&#039;,&#039;mu fit&#039;] if comparison == &#039;Estimating mu&#039; else &#91;&#039;std&#039;,&#039;MAD*k&#039;,&#039;sigma fit&#039;]):
		fig.histogram(
			results_df&#91;col],
			label = col,
		)
	fig.plotly_figure.add_vline(
		x = 0 if &#039;mu&#039; in comparison else 1,
		annotation_text = &#039;µ&#039; if &#039;mu&#039; in comparison else &#039;σ&#039;,
	)

grafica.save_unsaved(mkdir=&#039;plots&#039;)
</pre></div><div class="speaker-mute footnotes_reference_container"> <div class="footnote_container_prepare"><p><span role="button" tabindex="0" class="footnote_reference_container_label pointer" onclick="footnote_expand_collapse_reference_container_824_2();">References</span><span role="button" tabindex="0" class="footnote_reference_container_collapse_button" style="display: none;" onclick="footnote_expand_collapse_reference_container_824_2();">[<a id="footnote_reference_container_collapse_button_824_2">+</a>]</span></p></div> <div id="footnote_references_container_824_2" style=""><table class="footnotes_table footnote-reference-container"><caption class="accessibility">References</caption> <tbody> 

<tr class="footnotes_plugin_reference_row"> <th scope="row" class="footnote_plugin_index_combi pointer"  onclick="footnote_moveToAnchor_824_2('footnote_plugin_tooltip_824_2_1');"><a id="footnote_plugin_reference_824_2_1" class="footnote_backlink"><span class="footnote_index_arrow">&#8593;</span>1</a></th> <td class="footnote_plugin_text">The <code>99</code>, in case you didn&#8217;t noticed it.</td></tr>

<tr class="footnotes_plugin_reference_row"> <th scope="row" class="footnote_plugin_index_combi pointer"  onclick="footnote_moveToAnchor_824_2('footnote_plugin_tooltip_824_2_2');"><a id="footnote_plugin_reference_824_2_2" class="footnote_backlink"><span class="footnote_index_arrow">&#8593;</span>2</a></th> <td class="footnote_plugin_text">See <a href="https://en.wikipedia.org/wiki/Median_absolute_deviation#Relation_to_standard_deviation" data-type="URL" data-id="https://en.wikipedia.org/wiki/Median_absolute_deviation#Relation_to_standard_deviation">here</a>.</td></tr>

<tr class="footnotes_plugin_reference_row"> <th scope="row" class="footnote_plugin_index_combi pointer"  onclick="footnote_moveToAnchor_824_2('footnote_plugin_tooltip_824_2_3');"><a id="footnote_plugin_reference_824_2_3" class="footnote_backlink"><span class="footnote_index_arrow">&#8593;</span>3</a></th> <td class="footnote_plugin_text">Well, the standard deviation is properly doing its job, what is wrong here is that there are outliers&#8230;</td></tr>

<tr class="footnotes_plugin_reference_row"> <th scope="row" class="footnote_plugin_index_combi pointer"  onclick="footnote_moveToAnchor_824_2('footnote_plugin_tooltip_824_2_4');"><a id="footnote_plugin_reference_824_2_4" class="footnote_backlink"><span class="footnote_index_arrow">&#8593;</span>4</a></th> <td class="footnote_plugin_text">when your data is Gaussian!</td></tr>

<tr class="footnotes_plugin_reference_row"> <th scope="row" class="footnote_plugin_index_combi pointer"  onclick="footnote_moveToAnchor_824_2('footnote_plugin_tooltip_824_2_5');"><a id="footnote_plugin_reference_824_2_5" class="footnote_backlink"><span class="footnote_index_arrow">&#8593;</span>5</a></th> <td class="footnote_plugin_text">i.e. it is more complicated than <code>MAD=scipy.stats.median_abs_deviation(your_data)</code></td></tr>

 </tbody> </table> </div></div><script type="text/javascript"> function footnote_expand_reference_container_824_2() { jQuery('#footnote_references_container_824_2').show(); jQuery('#footnote_reference_container_collapse_button_824_2').text('−'); } function footnote_collapse_reference_container_824_2() { jQuery('#footnote_references_container_824_2').hide(); jQuery('#footnote_reference_container_collapse_button_824_2').text('+'); } function footnote_expand_collapse_reference_container_824_2() { if (jQuery('#footnote_references_container_824_2').is(':hidden')) { footnote_expand_reference_container_824_2(); } else { footnote_collapse_reference_container_824_2(); } } function footnote_moveToReference_824_2(p_str_TargetID) { footnote_expand_reference_container_824_2(); var l_obj_Target = jQuery('#' + p_str_TargetID); if (l_obj_Target.length) { jQuery( 'html, body' ).delay( 0 ); jQuery('html, body').animate({ scrollTop: l_obj_Target.offset().top - window.innerHeight * 0.2 }, 380); } } function footnote_moveToAnchor_824_2(p_str_TargetID) { footnote_expand_reference_container_824_2(); var l_obj_Target = jQuery('#' + p_str_TargetID); if (l_obj_Target.length) { jQuery( 'html, body' ).delay( 0 ); jQuery('html, body').animate({ scrollTop: l_obj_Target.offset().top - window.innerHeight * 0.2 }, 380); } }</script>]]></content:encoded>
					
		
		
			</item>
	</channel>
</rss>
