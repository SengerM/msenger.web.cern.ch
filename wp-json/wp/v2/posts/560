{"id":560,"date":"2021-03-18T03:28:00","date_gmt":"2021-03-18T03:28:00","guid":{"rendered":"https:\/\/msenger.web.cern.ch\/?p=560"},"modified":"2021-03-25T08:27:45","modified_gmt":"2021-03-25T08:27:45","slug":"characterization-of-delay-in-psi-test-setup","status":"publish","type":"post","link":"https:\/\/msenger.web.cern.ch\/characterization-of-delay-in-psi-test-setup\/","title":{"rendered":"Characterization of delay in PSI test setup"},"content":{"rendered":"<style>.kb-table-of-content-nav.kb-table-of-content-id_d94885-0f .kb-table-of-content-wrap{padding-top:var(--global-kb-spacing-sm, 1.5rem);padding-right:var(--global-kb-spacing-sm, 1.5rem);padding-bottom:var(--global-kb-spacing-sm, 1.5rem);padding-left:var(--global-kb-spacing-sm, 1.5rem);}.kb-table-of-content-nav.kb-table-of-content-id_d94885-0f .kb-table-of-contents-title-wrap{padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;}.kb-table-of-content-nav.kb-table-of-content-id_d94885-0f .kb-table-of-contents-title{font-weight:regular;font-style:normal;}.kb-table-of-content-nav.kb-table-of-content-id_d94885-0f .kb-table-of-content-wrap .kb-table-of-content-list{font-weight:regular;font-style:normal;margin-top:var(--global-kb-spacing-sm, 1.5rem);margin-right:0px;margin-bottom:0px;margin-left:0px;}<\/style>\n\n\n<h2 class=\"wp-block-heading\">Introduction<\/h2>\n\n\n\n<p>I am working in the development of a position+time readout chip for 4D pixel detectors in collaboration with the group at <a rel=\"noreferrer noopener\" href=\"https:\/\/en.wikipedia.org\/wiki\/Paul_Scherrer_Institute\" data-type=\"URL\" data-id=\"https:\/\/en.wikipedia.org\/wiki\/Paul_Scherrer_Institute\" target=\"_blank\">PSI<\/a>. The project has already started when I joined and there are already some designs that have been implemented in test structures, which have to be characterized. For this, the group at PSI developed a test setup which is controlled by a Raspberry Pi and has an FPGA with some peripherals, you can see in the following pictures:<\/p>\n\n\n<style>.wp-block-kadence-advancedgallery .kb-gallery-type-masonry.kb-gallery-id-_cd682d-a8{margin:-5px;}.kb-gallery-type-masonry.kb-gallery-id-_cd682d-a8 .kadence-blocks-gallery-item{padding:5px;}.kb-gallery-id-_cd682d-a8 .kadence-blocks-gallery-item .kb-gal-image-radius{border-radius:0px 0px 0px 0px;}<\/style>\n<div class=\"wp-block-kadence-advancedgallery kb-gallery-wrap-id-_cd682d-a8\"><ul class=\"kb-gallery-ul kb-gallery-type-masonry kb-masonry-init kb-gallery-id-_cd682d-a8 kb-gallery-caption-style-bottom-hover kb-gallery-filter-none kb-gallery-magnific-init\" data-item-selector=\".kadence-blocks-gallery-item\" data-image-filter=\"none\" data-lightbox-caption=\"false\" data-columns-xxl=\"2\" data-columns-xl=\"2\" data-columns-lg=\"2\" data-columns-md=\"2\" data-columns-sm=\"1\" data-columns-xs=\"1\"><li class=\"kadence-blocks-gallery-item\"><div class=\"kadence-blocks-gallery-item-inner\"><figure class=\"kb-gallery-figure kb-gallery-item-has-link kadence-blocks-gallery-item-hide-caption\"><a href=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-57-36.jpg\" class=\"kb-gallery-item-link\"><div class=\"kb-gal-image-radius\" style=\"max-width:177px\"><div class=\"kb-gallery-image-contain kadence-blocks-gallery-intrinsic\" style=\"padding-bottom:169.4915254237288%\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-57-36-177x300.jpg\" width=\"177\" height=\"300\" data-full-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-57-36.jpg\" data-light-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-57-36.jpg\" data-id=\"563\" data-link=\"https:\/\/msenger.web.cern.ch\/?attachment_id=563\" class=\"wp-image-563undefined\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-57-36-177x300.jpg 177w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-57-36.jpg 577w\" sizes=\"(max-width: 177px) 100vw, 177px\" \/><\/div><\/div><\/a><\/figure><\/div><\/li><li class=\"kadence-blocks-gallery-item\"><div class=\"kadence-blocks-gallery-item-inner\"><figure class=\"kb-gallery-figure kb-gallery-item-has-link kadence-blocks-gallery-item-hide-caption\"><a href=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-57-43.jpg\" class=\"kb-gallery-item-link\"><div class=\"kb-gal-image-radius\" style=\"max-width:192px\"><div class=\"kb-gallery-image-contain kadence-blocks-gallery-intrinsic\" style=\"padding-bottom:156.25%\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-57-43-192x300.jpg\" width=\"192\" height=\"300\" data-full-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-57-43.jpg\" data-light-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-57-43.jpg\" data-id=\"564\" data-link=\"https:\/\/msenger.web.cern.ch\/?attachment_id=564\" class=\"wp-image-564undefined\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-57-43-192x300.jpg 192w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-57-43.jpg 651w\" sizes=\"(max-width: 192px) 100vw, 192px\" \/><\/div><\/div><\/a><\/figure><\/div><\/li><\/ul><\/div>\n\n\n\n<p>The setup is composed of many boards that interconnect between themselves. One of the boards, which is the core of the setup for TDC<span class=\"footnote_referrer\"><a role=\"button\" tabindex=\"0\" onclick=\"footnote_moveToReference_560_1('footnote_plugin_reference_560_1_1');\" onkeypress=\"footnote_moveToReference_560_1('footnote_plugin_reference_560_1_1');\" ><sup id=\"footnote_plugin_tooltip_560_1_1\" class=\"footnote_plugin_tooltip_text\">[1]<\/sup><\/a><span id=\"footnote_plugin_tooltip_text_560_1_1\" class=\"footnote_tooltip\">Time to Digital Converter.<\/span><\/span><script type=\"text\/javascript\"> jQuery('#footnote_plugin_tooltip_560_1_1').tooltip({ tip: '#footnote_plugin_tooltip_text_560_1_1', tipClass: 'footnote_tooltip', effect: 'fade', predelay: 0, fadeInSpeed: 200, delay: 400, fadeOutSpeed: 200, position: 'top center', relative: true, offset: [-7, 0], });<\/script> testing, contains two <a href=\"https:\/\/www.microchip.com\/wwwproducts\/en\/SY89296\" data-type=\"URL\" data-id=\"https:\/\/www.microchip.com\/wwwproducts\/en\/SY89296\">SY89296<\/a> delay chips that produce a start and a stop signals with a very precise time difference that can be controlled digitally. Below there is a picture of the so called &#8220;adapter board&#8221; with the two delay chips and the lines that carry the signal from the chips to the connector where later on the test structure will be.<\/p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-large is-resized\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-52-07.jpg\" alt=\"\" class=\"wp-image-566\" width=\"456\" height=\"400\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-52-07.jpg 720w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-52-07-300x263.jpg 300w\" sizes=\"(max-width: 456px) 100vw, 456px\" \/><figcaption>Adapter board with the two delay chips.<\/figcaption><\/figure><\/div>\n\n\n\n<p>This is very nice for characterizing the TDC test structures because we can program a specific time difference between the start and stop signal and see how the TDC responds. But before taking any conclusion from such a test of a TDC we must know how precise and accurate this test setup is. So today I will write about this.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Setup description<\/h2>\n\n\n\n<p>The setup for this characterization is very simple, as you can see in this picture:<\/p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-large is-resized\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-51-59.jpg\" alt=\"\" class=\"wp-image-568\" width=\"582\" height=\"492\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-51-59.jpg 851w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-51-59-300x254.jpg 300w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/photo_2021-03-16_11-51-59-768x650.jpg 768w\" sizes=\"(max-width: 582px) 100vw, 582px\" \/><figcaption>Picture of the setup which contains the &#8220;test setup&#8221; connected to a high speed oscilloscope.<\/figcaption><\/figure><\/div>\n\n\n\n<p>A block diagram of the setup can be sketched like this:<\/p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-large is-resized\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/1-1.svg\" alt=\"\" class=\"wp-image-577\" width=\"757\" height=\"340\"\/><\/figure><\/div>\n\n\n\n<p>The FPGA produces a pair of pulses each for each input of the delay chips, labeled A and B. Each of these chips has some specific configuration for D and FTUNE. As a result, each produces a certain delay until the output transitions from 0 to 1. The two outputs are measured with the oscilloscope<span class=\"footnote_referrer\"><a role=\"button\" tabindex=\"0\" onclick=\"footnote_moveToReference_560_1('footnote_plugin_reference_560_1_2');\" onkeypress=\"footnote_moveToReference_560_1('footnote_plugin_reference_560_1_2');\" ><sup id=\"footnote_plugin_tooltip_560_1_2\" class=\"footnote_plugin_tooltip_text\">[2]<\/sup><\/a><span id=\"footnote_plugin_tooltip_text_560_1_2\" class=\"footnote_tooltip\"><a href=\"https:\/\/cdn.teledynelecroy.com\/files\/pdf\/waverunner-6zi-datasheet.pdf\">Lecroy WaveRunner 640Zi<\/a>, 4 GHz, 40 GS\/s.<\/span><\/span><script type=\"text\/javascript\"> jQuery('#footnote_plugin_tooltip_560_1_2').tooltip({ tip: '#footnote_plugin_tooltip_text_560_1_2', tipClass: 'footnote_tooltip', effect: 'fade', predelay: 0, fadeInSpeed: 200, delay: 400, fadeOutSpeed: 200, position: 'top center', relative: true, offset: [-7, 0], });<\/script>.<\/p>\n\n\n\n<p>I just connected each of the two outputs from the delay chips to the two inputs of a high speed oscilloscope and started measuring the time difference between each signal for different programming configurations. To measure the time difference between the two signals I used one of the &#8220;measure functions&#8221; provided by the oscilloscope. I configured it to measure the time difference between two rising edges at a level of 1 V, as seen in the following screenshot:<\/p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-large\"><img loading=\"lazy\" decoding=\"async\" width=\"1024\" height=\"777\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/Screenshot_2021-03-06_08-50-01-1024x777.png\" alt=\"\" class=\"wp-image-569\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/Screenshot_2021-03-06_08-50-01-1024x777.png 1024w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/Screenshot_2021-03-06_08-50-01-300x227.png 300w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/Screenshot_2021-03-06_08-50-01-768x582.png 768w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/03\/Screenshot_2021-03-06_08-50-01.png 1291w\" sizes=\"(max-width: 1024px) 100vw, 1024px\" \/><\/figure><\/div>\n\n\n\n<p>After setting up the oscilloscope I proceeded to program the Raspberry Pi (which is part of the PSI test setup) to scan on the delay difference between the two chips. If we look into the <a href=\"https:\/\/ww1.microchip.com\/downloads\/en\/DeviceDoc\/sy89296u.pdf\">datasheet of these chips<\/a>, they have two ways of controlling the delay:<\/p>\n\n\n\n<ol><li>Through the digital value written to the <code>D[9:0]<\/code> control bits. This is the main delay control and goes from 0 to 9 ns in steps of about 10 ps.<\/li><li>Through the analog voltage in the <code>FTUNE<\/code> pin. As the name suggests, this provides a fine tune of the delay. It goes from 0 to 50 ps with a voltage that ranges from 0 to 1.25 V.<\/li><\/ol>\n\n\n\n<h2 class=\"wp-block-heading\">Results of measurements<\/h2>\n\n\n\n<p>I proceeded to measure the delay as a function of each of these two settings, D and FTUNE, separately. <\/p>\n\n\n\n<h3 class=\"wp-block-heading\">Delay vs D[9:0]<\/h3>\n\n\n\n<p>Let&#8217;s start with the delay measured for different values of D. For each value of D shown in this section I measured \u0394t for 999 events. So at each value of D I have 999 different \u0394t values. I studied each of the two delay chips individually. So when I was sweeping D for chip A I left D=0 in chip B and viceversa. <\/p>\n\n\n\n<p>If I average all the \u0394t values at each D I obtain this:<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210316%20Characterization%20of%20delay%20in%20PSI%20test%20setup\/D\/Measured%20delay%20average%20vs%20set%20delay.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>As can be seen the chip A produces positive values of \u0394t while chip B produces negative values. Since D is supposed to be the delay in tens of picosecond I have plotted with the x axis being D\u00d710 ps, and I have also plotted y = |x| which is what the delay ideally should follow. There are, however, a number of appreciable deviations from this ideal behavior. <\/p>\n\n\n\n<ol><li>To start with, there is an offset. If you zoom into the region where D=0 you will note there is an offset of about 100 ps. There are many possible reasons for this offset: Internal offsets from the chips themselves, an offset from the two signals produced by the FPGA and even a difference in the length of the two cables I used to connect the oscilloscope (a difference in time of 100 ps should correspond to a difference in length of about 2 cm which is certainly possible). <\/li><li>Another effect we can see is that the slope of each line is not what we would expect (compare against y = |x|). The reason for this can only be attributed to the delay chips.<\/li><li>Finally, there is a &#8220;high frequency oscillation&#8221; that seems to be constant along all the two lines. If you zoom in in any region you will appreciate it better. This effect can only be attributed to the delay chips.<\/li><\/ol>\n\n\n\n<p>The previous plot shows an &#8220;absolute measurement of \u0394t&#8221;. In order to compare the behavior of each delay chip with the other I subtracted the offset from the two lines and inverted the one for chip B. This is what I got:<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210316%20Characterization%20of%20delay%20in%20PSI%20test%20setup\/D\/Measured%20delay%20average%20vs%20set%20delay%20superimposing%20both%20chips%20and%20removing%20offset.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>Here it is very clear that the slope is not exactly 10 ps\/D and also that each chip has a slightly different slope. We can also see that the high frequency oscillations are exactly the same for the two delay chips. <\/p>\n\n\n\n<p>In <a href=\"https:\/\/ww1.microchip.com\/downloads\/en\/DeviceDoc\/sy89296u.pdf#page=10\" data-type=\"URL\" data-id=\"https:\/\/ww1.microchip.com\/downloads\/en\/DeviceDoc\/sy89296u.pdf#page=10\">page 10 of the datasheet<\/a> we find the specification for the delay in picoseconds vs the value of D. There we see that the slope is specified to be 9 ps\/D. As far as I know it is not mentioned the high frequency oscillation and the variations of this slope from chip to chip. <\/p>\n\n\n\n<h4 class=\"wp-block-heading\">Delay fluctuations vs D<\/h4>\n\n\n\n<p>Another important question is: How does \u0394t fluctuates? To address this question I just took the same dataset I showed before and observed the distribution and standard deviation of \u0394t at each value of D. The distribution of \u0394t looks very Gaussian, as can be appreciated in this example:<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210316%20Characterization%20of%20delay%20in%20PSI%20test%20setup\/D\/Distribution%20of%20Delta_t%20for%20delay%20to%20chip%20A%20D%20318%20.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>From this fit I obtain a fluctiation of 3.71 ps. Repeating this for all values of D I obtain this:<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210316%20Characterization%20of%20delay%20in%20PSI%20test%20setup\/D\/Delay%20fluctuations%20vs%20set%20delay.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>Here we see that there seems to be a slight increase in the fluctuations for higher values of D. The fluctuations of \u0394t are around 3.4-3.8 ps.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\">Delay vs FTUNE voltage<\/h3>\n\n\n\n<p>Next I proceeded to characterize \u0394t vs the FTUNE voltage. I proceeded the same way: When I was varying FTUNE for chip A I left FTUNE for chip B at 0 V. Also, the value of D for both chips was left constant at 0. This is what I obtained:<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210316%20Characterization%20of%20delay%20in%20PSI%20test%20setup\/FTUNE\/Measured%20delay%20average%20vs%20FTUNE%20voltage.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>As we see, the behavior this time is inverted as chip B produces positive delays and chip A negative ones, while for D this was the opposite way around, and it is also nonlinear. These two aspects are expected from the specification in <a href=\"https:\/\/ww1.microchip.com\/downloads\/en\/DeviceDoc\/sy89296u.pdf#page=10\">page 10 of the datasheet<\/a>.<\/p>\n\n\n\n<p>Removing the offset and plotting the two curves together we get:<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210316%20Characterization%20of%20delay%20in%20PSI%20test%20setup\/FTUNE\/Measured%20delay%20average%20vs%20FTUNE%20voltage%20superimposing%20both%20chips%20and%20removing%20offset.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>Here we see that there is a slight difference between the two chips, too. This is expected from the datasheet.<\/p>\n\n\n\n<h4 class=\"wp-block-heading\">Delay fluctuations vs FTUNE voltage<\/h4>\n\n\n\n<p>I also studied the fluctuations as the voltage in the FTUNE pin was varied. This is my result:<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210316%20Characterization%20of%20delay%20in%20PSI%20test%20setup\/FTUNE\/Delay%20fluctuations%20vs%20FTUNE%20voltage.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>We se that there is no appreciable dependence and that the fluctuations are around 3.8 ps. <\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Calibration<\/h2>\n\n\n\n<p>Using the information from the characterizations presented before I developed a program that automatically chooses the value for D<sub>A<\/sub>, D<sub>B<\/sub>, FTUNE<sub>A<\/sub> and FTUNE<sub>B<\/sub> in order to obtain some given delay. As can be seen in the next plot, the result was good. <\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210316%20Characterization%20of%20delay%20in%20PSI%20test%20setup\/Measured%20delay%20average%20vs%20set%20delay.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>With this program it is possible to choose a given value for \u0394t in seconds, either positive or negative, and the two chips are configured using the calibration measurements to produce such \u0394t. <\/p>\n\n\n\n<p>When testing this calibration I noticed that this setup seems to be very sensitive to temperature variations. To expose this I have measured many times the obtained delay given a certain set delay for different conditions, but always using the same calibration. Between each of these measurements I changed the warm-up-time before the measurement, just a dead time with the chips on before starting to measure, and also the measurement speed by changing the number of samples of \u0394t I took for each set time (the more samples the less the speed but higher statistics). When plotting the error in the obtained average delay with respect to the set delay, i.e. &#8220;average measured delay minus set delay&#8221; I obtain this:<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210316%20Characterization%20of%20delay%20in%20PSI%20test%20setup\/Delay%20error.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>First let&#8217;s start comparing all the curves at speed 2.474 (this speed is arbitrary, I defined taking into account the number of samples taken at each set delay and the number of different values of set delay measured). It is possible to hide the other curves by clicking on the legend of the plot. For these curves we see that the best ones are those two with 5 minutes warm up, because they have the smallest delay error. The other two curves, &#8220;no warm up&#8221; and &#8220;1 min warm up&#8221; have a very big error at -4 ns, which is where the measurement started. For higher values of set delay the error is less, this is because as the time passed the chips warmed up. Between these two measurements we see that the measurement with no warm up is better than the measurement with 1 minute warm up. I don&#8217;t understand this, I have some ideas but with no certainty to understand these result. <\/p>\n\n\n\n<p>Now we can compare the two curves with no warm up but with different speeds. We see that the one that has speed 0.243 is better than the other one. This is reasonable if the effect is due to warm up because a the two measurements took the same time to warm up but one of them is slower, so it takes more samples after it has already warmed up. <\/p>\n\n\n\n<p>Finally, we can look at the &#8220;high statistics, speed 0.008&#8221; trace. This measurement was taken during a long time laps (about 15 hours in total). In this measurement we can see some interesting effects. First, between -4 ns and -3.9 ns we see that there seems the be a similar effect of warm up as in the previous measurements discussed. Next, the delay error slowly increases at a constant rate. Between 3.5 ns and 3.65 ns there is a strange peak and then the curve continues until in the end starts to decrease. The peak at 3.5 ns concides with the moment a person opened the door of the lab and entered there for a few minutes, so my suspect is that there was some change in the temperature of the room due to opening the door and this produced this peak. The slow positive slope along the whole trace may be an effect of the daily temperature modulation.<\/p>\n\n\n\n<p>With respect to the fluctuations in the delay, I obtained this for each of the previous measurements:<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210316%20Characterization%20of%20delay%20in%20PSI%20test%20setup\/Delay%20fluctuations.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>As can be seen the measurements with no warm up and the one with 1 min warm up start at -4 ns with a high fluctuation. This is consistent with a warm up transient period. Some of the traces have peaks at other times. Since these measurements have low statistics (33 samples at each value of set delay, except the &#8220;high statistics&#8221; trace which has 999 samples at each point) these peaks are probably statistical fluctuations and we can ignore them. In average, the fluctuations were between 4 and 4.5 ps, as seen. There is also an effect I cannot understand yet that the fluctuations seem to slightly increase, up to 6 ps, to the end of the measurements (set delay = 4 ns). In the high statistics trace we can also see a small modulation, which I don&#8217;t understand. <\/p>\n\n\n\n<p>To conclude with the calibration, we can compare the results before and after this calibration was implemented. Just for ease of comparison, I will put again two of the plots previously shown:<\/p>\n\n\n\n<div class=\"wp-block-columns alignfull is-layout-flex wp-container-core-columns-layout-1 wp-block-columns-is-layout-flex\">\n<div class=\"wp-block-column is-layout-flow wp-block-column-is-layout-flow\">\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210316%20Characterization%20of%20delay%20in%20PSI%20test%20setup\/D\/Measured%20delay%20average%20vs%20set%20delay.html\" width=\"100%\" height=\"444\"><\/iframe>\n<\/div>\n\n\n\n<div class=\"wp-block-column is-layout-flow wp-block-column-is-layout-flow\">\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210316%20Characterization%20of%20delay%20in%20PSI%20test%20setup\/Measured%20delay%20average%20vs%20set%20delay.html\" width=\"100%\" height=\"444\"><\/iframe>\n\n\n\n<p><\/p>\n<\/div>\n<\/div>\n\n\n\n<p>Despite all the effects observed, we can see that this calibration greatly improves the results.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Software developed<\/h2>\n\n\n\n<p>During the process I developed a Python package with the aim to easily control the PSI test setup using a modern programming language. The software can be found in <a href=\"https:\/\/github.com\/SengerM\/PSITestSetup\" data-type=\"URL\" data-id=\"https:\/\/github.com\/SengerM\/PSITestSetup\">this link<\/a><span class=\"footnote_referrer\"><a role=\"button\" tabindex=\"0\" onclick=\"footnote_moveToReference_560_1('footnote_plugin_reference_560_1_3');\" onkeypress=\"footnote_moveToReference_560_1('footnote_plugin_reference_560_1_3');\" ><sup id=\"footnote_plugin_tooltip_560_1_3\" class=\"footnote_plugin_tooltip_text\">[3]<\/sup><\/a><span id=\"footnote_plugin_tooltip_text_560_1_3\" class=\"footnote_tooltip\">As of now, the latest commit is <a href=\"https:\/\/github.com\/SengerM\/PSITestSetup\/commit\/930da4eabf375a8d2da5784a833483c64fc59429\" data-type=\"URL\" data-id=\"https:\/\/github.com\/SengerM\/PSITestSetup\/commit\/930da4eabf375a8d2da5784a833483c64fc59429\">930da4eabf375a8d2da5784a833483c64fc59429<\/a>.<\/span><\/span><script type=\"text\/javascript\"> jQuery('#footnote_plugin_tooltip_560_1_3').tooltip({ tip: '#footnote_plugin_tooltip_text_560_1_3', tipClass: 'footnote_tooltip', effect: 'fade', predelay: 0, fadeInSpeed: 200, delay: 400, fadeOutSpeed: 200, position: 'top center', relative: true, offset: [-7, 0], });<\/script>. The package can be easily installed in the Raspberri Pi of the test setup with a single command and then imported into any Python program. For more details see the <code>Readme.md<\/code> file in the repository.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Conclusion<\/h2>\n\n\n\n<ul><li>The timing characteristics of the test setup were studied.<\/li><li>The fluctuations in the \u0394t between the start and the stop signals, that will command the TDC, were found to be between 3.5 and 4.5 ps no matter which is the set delay.<\/li><li>A number of deviations from the specified behavior in the datasheet of the delay chips were found. Most of them could be corrected after a calibration procedure was implemented.<\/li><li>An important dependence between the mean value of the delay and the duration of the warm-up-period was found, probably due to the temperature increase of the delay chips.<\/li><li>There are some deviations that were observed and are still not understood.<\/li><\/ul>\n<div class=\"speaker-mute footnotes_reference_container\"> <div class=\"footnote_container_prepare\"><p><span role=\"button\" tabindex=\"0\" class=\"footnote_reference_container_label pointer\" onclick=\"footnote_expand_collapse_reference_container_560_1();\">References<\/span><span role=\"button\" tabindex=\"0\" class=\"footnote_reference_container_collapse_button\" style=\"display: none;\" onclick=\"footnote_expand_collapse_reference_container_560_1();\">[<a id=\"footnote_reference_container_collapse_button_560_1\">+<\/a>]<\/span><\/p><\/div> <div id=\"footnote_references_container_560_1\" style=\"\"><table class=\"footnotes_table footnote-reference-container\"><caption class=\"accessibility\">References<\/caption> <tbody> \r\n\r\n<tr class=\"footnotes_plugin_reference_row\"> <th scope=\"row\" class=\"footnote_plugin_index_combi pointer\"  onclick=\"footnote_moveToAnchor_560_1('footnote_plugin_tooltip_560_1_1');\"><a id=\"footnote_plugin_reference_560_1_1\" class=\"footnote_backlink\"><span class=\"footnote_index_arrow\">&#8593;<\/span>1<\/a><\/th> <td class=\"footnote_plugin_text\">Time to Digital Converter.<\/td><\/tr>\r\n\r\n<tr class=\"footnotes_plugin_reference_row\"> <th scope=\"row\" class=\"footnote_plugin_index_combi pointer\"  onclick=\"footnote_moveToAnchor_560_1('footnote_plugin_tooltip_560_1_2');\"><a id=\"footnote_plugin_reference_560_1_2\" class=\"footnote_backlink\"><span class=\"footnote_index_arrow\">&#8593;<\/span>2<\/a><\/th> <td class=\"footnote_plugin_text\"><a href=\"https:\/\/cdn.teledynelecroy.com\/files\/pdf\/waverunner-6zi-datasheet.pdf\">Lecroy WaveRunner 640Zi<\/a>, 4 GHz, 40 GS\/s.<\/td><\/tr>\r\n\r\n<tr class=\"footnotes_plugin_reference_row\"> <th scope=\"row\" class=\"footnote_plugin_index_combi pointer\"  onclick=\"footnote_moveToAnchor_560_1('footnote_plugin_tooltip_560_1_3');\"><a id=\"footnote_plugin_reference_560_1_3\" class=\"footnote_backlink\"><span class=\"footnote_index_arrow\">&#8593;<\/span>3<\/a><\/th> <td class=\"footnote_plugin_text\">As of now, the latest commit is <a href=\"https:\/\/github.com\/SengerM\/PSITestSetup\/commit\/930da4eabf375a8d2da5784a833483c64fc59429\" data-type=\"URL\" data-id=\"https:\/\/github.com\/SengerM\/PSITestSetup\/commit\/930da4eabf375a8d2da5784a833483c64fc59429\">930da4eabf375a8d2da5784a833483c64fc59429<\/a>.<\/td><\/tr>\r\n\r\n <\/tbody> <\/table> <\/div><\/div><script type=\"text\/javascript\"> function footnote_expand_reference_container_560_1() { jQuery('#footnote_references_container_560_1').show(); jQuery('#footnote_reference_container_collapse_button_560_1').text('\u2212'); } function footnote_collapse_reference_container_560_1() { jQuery('#footnote_references_container_560_1').hide(); jQuery('#footnote_reference_container_collapse_button_560_1').text('+'); } function footnote_expand_collapse_reference_container_560_1() { if (jQuery('#footnote_references_container_560_1').is(':hidden')) { footnote_expand_reference_container_560_1(); } else { footnote_collapse_reference_container_560_1(); } } function footnote_moveToReference_560_1(p_str_TargetID) { footnote_expand_reference_container_560_1(); var l_obj_Target = jQuery('#' + p_str_TargetID); if (l_obj_Target.length) { jQuery( 'html, body' ).delay( 0 ); jQuery('html, body').animate({ scrollTop: l_obj_Target.offset().top - window.innerHeight * 0.2 }, 380); } } function footnote_moveToAnchor_560_1(p_str_TargetID) { footnote_expand_reference_container_560_1(); var l_obj_Target = jQuery('#' + p_str_TargetID); if (l_obj_Target.length) { jQuery( 'html, body' ).delay( 0 ); jQuery('html, body').animate({ scrollTop: l_obj_Target.offset().top - window.innerHeight * 0.2 }, 380); } }<\/script>","protected":false},"excerpt":{"rendered":"<p>Introduction I am working in the development of a position+time readout chip for 4D pixel detectors in collaboration with the group at PSI. The project has already started when I joined and there are already some designs that have been implemented in test structures, which have to be characterized. For this, the group at PSI &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"\" href=\"https:\/\/msenger.web.cern.ch\/characterization-of-delay-in-psi-test-setup\/\"> <span class=\"screen-reader-text\">Characterization of delay in PSI test setup<\/span> Read More &raquo;<\/a><\/p>\n","protected":false},"author":1,"featured_media":566,"comment_status":"closed","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"inline_featured_image":false,"footnotes":""},"categories":[1],"tags":[16,6],"_links":{"self":[{"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/posts\/560"}],"collection":[{"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/comments?post=560"}],"version-history":[{"count":71,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/posts\/560\/revisions"}],"predecessor-version":[{"id":691,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/posts\/560\/revisions\/691"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/media\/566"}],"wp:attachment":[{"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/media?parent=560"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/categories?post=560"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/tags?post=560"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}