{"id":176,"date":"2021-01-14T01:11:12","date_gmt":"2021-01-14T01:11:12","guid":{"rendered":"https:\/\/msenger.web.cern.ch\/?p=176"},"modified":"2021-03-25T08:16:18","modified_gmt":"2021-03-25T08:16:18","slug":"first-application-of-the-empirical-likelihood-function-to-position-reconstruction-in-ac-lgad-detectors","status":"publish","type":"post","link":"https:\/\/msenger.web.cern.ch\/first-application-of-the-empirical-likelihood-function-to-position-reconstruction-in-ac-lgad-detectors\/","title":{"rendered":"First application of the empirical likelihood function to position reconstruction in AC-LGAD detectors"},"content":{"rendered":"\n<p>During the last days I was working on the application of the maximum &#8220;empirical likelihood&#8221; estimator for the hit position of a particle in an AC-LGAD. To get an introduction to this method, please have a look at this <a href=\"https:\/\/msenger.web.cern.ch\/empirical-likelihood-function-with-continuous-parameters\/\" data-type=\"URL\" data-id=\"https:\/\/msenger.web.cern.ch\/empirical-likelihood-function-with-continuous-parameters\/\">previous post<\/a>. Today I am going to write about how I am applying this method to the position reconstruction and I will show the first results. <\/p>\n\n\n<style>.kb-table-of-content-nav.kb-table-of-content-id_e9b078-0b .kb-table-of-content-wrap{padding-top:var(--global-kb-spacing-sm, 1.5rem);padding-right:var(--global-kb-spacing-sm, 1.5rem);padding-bottom:var(--global-kb-spacing-sm, 1.5rem);padding-left:var(--global-kb-spacing-sm, 1.5rem);}.kb-table-of-content-nav.kb-table-of-content-id_e9b078-0b .kb-table-of-contents-title-wrap{padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;}.kb-table-of-content-nav.kb-table-of-content-id_e9b078-0b .kb-table-of-contents-title{font-weight:regular;font-style:normal;}.kb-table-of-content-nav.kb-table-of-content-id_e9b078-0b .kb-table-of-content-wrap .kb-table-of-content-list{font-weight:regular;font-style:normal;margin-top:var(--global-kb-spacing-sm, 1.5rem);margin-right:0px;margin-bottom:0px;margin-left:0px;}<\/style>\n\n\n<h2 class=\"wp-block-heading\">Setup<\/h2>\n\n\n\n<p>I am using an AC-LGAD detector that has the following inscription: &#8220;RSD 1 W8-A &#8211; 2,5 3\u00d73 100&#8221;. This is a picture of it:<\/p>\n\n\n\n<div class=\"wp-block-image is-style-rounded\"><figure class=\"aligncenter size-large is-resized\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/photo_2021-01-13_23-27-03-1024x953.jpg\" alt=\"\" class=\"wp-image-178\" width=\"407\" height=\"378\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/photo_2021-01-13_23-27-03-1024x953.jpg 1024w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/photo_2021-01-13_23-27-03-300x279.jpg 300w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/photo_2021-01-13_23-27-03-768x715.jpg 768w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/photo_2021-01-13_23-27-03.jpg 1080w\" sizes=\"(max-width: 407px) 100vw, 407px\" \/><figcaption>An AC-LGAD wire bonded to a carrier board.<\/figcaption><\/figure><\/div>\n\n\n\n<p>The detector is attached and wire bonded to a board to which I connect an oscilloscope and measure the signal coming out from each of the four channels. The board is mounted inside a TCT like the one in <a href=\"http:\/\/particulars.si\/products.php?prod=LargeScanTCT.html\" data-type=\"URL\" data-id=\"http:\/\/particulars.si\/products.php?prod=LargeScanTCT.html\">this link<\/a>. The intensity of the laser was not tuned against a MIP.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">The position reconstruction algorithm<\/h2>\n\n\n\n<p> The general idea of the algorithm was presented in <a href=\"https:\/\/msenger.web.cern.ch\/empirical-likelihood-function-with-continuous-parameters\/\" data-type=\"URL\" data-id=\"https:\/\/msenger.web.cern.ch\/empirical-likelihood-function-with-continuous-parameters\/\">this post<\/a> some days ago. Today I want to give some specific details of the current implementation.  <\/p>\n\n\n\n<p>So, there is an AC-LGAD that basically looks like this:<\/p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-large is-resized\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/tct-detector-drawing.svg\" alt=\"\" class=\"wp-image-60\" width=\"532\" height=\"213\"\/><\/figure><\/div>\n\n\n\n<p>and what I want to do is to use information measured at each pad \\(i \\in \\{1,2,3,4\\}\\) to reconstruct the position \\(x_0,y_0\\). Throughout today&#8217;s post the only quantities used to reconstruct the impact position are the four collected charges \\( Q_1, Q_2, Q_3 \\) and \\( Q_4 \\). I used only the charge because it is the most sensitive quantity to the position. I did not normalized the charge and\/or used the charge share fraction for each pad, which would have been better, because this requires some criterion in order to normalize the charge collected by each pad, and this is not trivial. Today I just wanted to test the algorithm applied to this problem, not to obtain the best reconstruction method.<\/p>\n\n<p>The &#8220;likelihood function&#8221; was defined as <\/p>\n\n\n\n<div class=\"wp-block-mathml-mathmlblock\">\\[ \\mathscr{L}( q_1, q_2, q_3, q_4 | x, y ) := \\prod_{i=1}^4 f_{Q_i}(q_i | x,y) \\]<script src=\"https:\/\/msenger.web.cern.ch\/wp-includes\/js\/dist\/vendor\/wp-polyfill-inert.min.js?ver=3.1.2\" id=\"wp-polyfill-inert-js\"><\/script>\n<script src=\"https:\/\/msenger.web.cern.ch\/wp-includes\/js\/dist\/vendor\/regenerator-runtime.min.js?ver=0.14.0\" id=\"regenerator-runtime-js\"><\/script>\n<script src=\"https:\/\/msenger.web.cern.ch\/wp-includes\/js\/dist\/vendor\/wp-polyfill.min.js?ver=3.15.0\" id=\"wp-polyfill-js\"><\/script>\n<script src=\"https:\/\/msenger.web.cern.ch\/wp-includes\/js\/dist\/hooks.min.js?ver=c6aec9a8d4e5a5d543a1\" id=\"wp-hooks-js\"><\/script>\n<script src=\"https:\/\/msenger.web.cern.ch\/wp-includes\/js\/dist\/i18n.min.js?ver=7701b0c3857f914212ef\" id=\"wp-i18n-js\"><\/script>\n<script id=\"wp-i18n-js-after\">\nwp.i18n.setLocaleData( { 'text direction\\u0004ltr': [ 'ltr' ] } );\n<\/script>\n<script  async src=\"https:\/\/cdnjs.cloudflare.com\/ajax\/libs\/mathjax\/2.7.7\/MathJax.js?config=TeX-MML-AM_CHTML\" id=\"mathjax-js\"><\/script>\n<\/div>\n\n\n\n<p> where \\( f_{Q_i} \\) is the empirical distribution function for the collected charge of the \\( i \\)-th channel. Some remarks:<\/p>\n<ul>\n<li>I refer to this distribution functions as &#8220;empirical&#8221; since I don&#8217;t have an analytical expression for them, but instead they were approximated to measured data using the Gaussian KDE approximation, as detailed in the previously referred post. To this approximation process I will refer to as &#8220;training&#8221;.<\/li>\n<li>Note that I have also placed quotation marks in <emph>&#8220;likelihood function&#8221;<\/emph>. The reason for this is that, despite the function defined above resembles a likelihood function, it is not so in a strict sense because the four random variables \\( Q_i \\) are not independent (in fact are strongly correlated) and thus the joint distribution is not the product of the marginal distributions.<\/li>\n<li>I have built the &#8220;likelihood function&#8221; without any pre-processing of the data, I just fed the collected charge from each channel to the training algorithm and then used it to reconstruct the position. This is not the best approach since it will probably be highly dependent on the gain for each channel and maybe some other factors too.<\/li>\n<\/ul>\n<p> Today, however, I am working in a proof of concept of this idea. Improvements will come later. <\/p>\n<p> After the algorithm was trained, i.e. after the empirical &#8220;likelihood function&#8221; was constructed, the position estimation is done by maximizing this function in \\( x \\) and \\( y \\) for some particular observation of \\( Q_i \\). This maximization comes associated with some difficulties which I will show and discuss later on. The result of the maximization is the estimated impact point \\( x_\\text{estimated} , y_\\text{estimated} \\). <\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Training the position reconstruction algorithm<\/h2>\n\n\n\n<p> I call &#8220;training the algorithm&#8221; to the process of feeding measured data to it with both the impact position \\( x,y \\) and the collected charge \\( Q_i \\) for each of the four channels. Using this information, the algorithm creates approximations for the distribution functions \\( f_{Q_i} \\) at each \\( x,y \\) and then performs an interpolation to get it approximated to any \\( x,y \\). <\/p>\n\n\n\n<h3 class=\"wp-block-heading\">Training data<\/h3>\n\n\n\n<p>To produce the training data I shined the TCT&#8217;s pulsed laser into many different \\( x,y \\) positions of the AC-LGAD detector. In each \\( x,y \\) point I measured the collected charge for each of the 4 channels for 333 different laser shots. The average collected charge for each of the four channels can be seen in the plots below:<\/p>\n\n\n<style>.wp-block-kadence-advancedgallery .kb-gallery-type-grid.kb-gallery-id-_c2f7d7-f9{margin:-5px;}.kb-gallery-type-grid.kb-gallery-id-_c2f7d7-f9 .kadence-blocks-gallery-item{padding:5px;}.kb-gallery-id-_c2f7d7-f9 .kadence-blocks-gallery-item .kb-gal-image-radius{border-radius:0px 0px 0px 0px;}<\/style>\n<div class=\"wp-block-kadence-advancedgallery kb-gallery-wrap-id-_c2f7d7-f9\"><ul class=\"kb-gallery-ul kb-gallery-type-grid kb-gallery-id-_c2f7d7-f9 kb-gallery-caption-style-bottom-hover kb-gallery-filter-none kb-gallery-magnific-init\" data-item-selector=\".kadence-blocks-gallery-item\" data-image-filter=\"none\" data-lightbox-caption=\"false\" data-columns-xxl=\"2\" data-columns-xl=\"2\" data-columns-lg=\"2\" data-columns-md=\"2\" data-columns-sm=\"1\" data-columns-xs=\"1\"><li class=\"kadence-blocks-gallery-item\"><div class=\"kadence-blocks-gallery-item-inner\"><figure class=\"kb-gallery-figure kb-gallery-item-has-link kadence-blocks-gallery-item-hide-caption kb-has-image-ratio-inherit\"><a href=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH4-mean-value.png\" class=\"kb-gallery-item-link\"><div class=\"kb-gal-image-radius\" style=\"max-width:640px\"><div class=\"kb-gallery-image-contain kadence-blocks-gallery-intrinsic kb-gallery-image-ratio-inherit\" style=\"padding-bottom:75%\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH4-mean-value.png\" width=\"640\" height=\"480\" alt=\"\" data-full-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH4-mean-value.png\" data-light-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH4-mean-value.png\" data-id=\"189\" data-link=\"https:\/\/msenger.web.cern.ch\/?attachment_id=189\" class=\"wp-image-189undefined\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH4-mean-value.png 640w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH4-mean-value-300x225.png 300w\" sizes=\"(max-width: 640px) 100vw, 640px\" \/><\/div><\/div><\/a><\/figure><\/div><\/li><li class=\"kadence-blocks-gallery-item\"><div class=\"kadence-blocks-gallery-item-inner\"><figure class=\"kb-gallery-figure kb-gallery-item-has-link kadence-blocks-gallery-item-hide-caption kb-has-image-ratio-inherit\"><a href=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH3-mean-value.png\" class=\"kb-gallery-item-link\"><div class=\"kb-gal-image-radius\" style=\"max-width:640px\"><div class=\"kb-gallery-image-contain kadence-blocks-gallery-intrinsic kb-gallery-image-ratio-inherit\" style=\"padding-bottom:75%\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH3-mean-value.png\" width=\"640\" height=\"480\" alt=\"\" data-full-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH3-mean-value.png\" data-light-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH3-mean-value.png\" data-id=\"188\" data-link=\"https:\/\/msenger.web.cern.ch\/?attachment_id=188\" class=\"wp-image-188undefined\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH3-mean-value.png 640w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH3-mean-value-300x225.png 300w\" sizes=\"(max-width: 640px) 100vw, 640px\" \/><\/div><\/div><\/a><\/figure><\/div><\/li><li class=\"kadence-blocks-gallery-item\"><div class=\"kadence-blocks-gallery-item-inner\"><figure class=\"kb-gallery-figure kb-gallery-item-has-link kadence-blocks-gallery-item-hide-caption kb-has-image-ratio-inherit\"><a href=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH1-mean-value.png\" class=\"kb-gallery-item-link\"><div class=\"kb-gal-image-radius\" style=\"max-width:640px\"><div class=\"kb-gallery-image-contain kadence-blocks-gallery-intrinsic kb-gallery-image-ratio-inherit\" style=\"padding-bottom:75%\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH1-mean-value.png\" width=\"640\" height=\"480\" alt=\"\" data-full-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH1-mean-value.png\" data-light-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH1-mean-value.png\" data-id=\"186\" data-link=\"https:\/\/msenger.web.cern.ch\/?attachment_id=186\" class=\"wp-image-186undefined\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH1-mean-value.png 640w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH1-mean-value-300x225.png 300w\" sizes=\"(max-width: 640px) 100vw, 640px\" \/><\/div><\/div><\/a><\/figure><\/div><\/li><li class=\"kadence-blocks-gallery-item\"><div class=\"kadence-blocks-gallery-item-inner\"><figure class=\"kb-gallery-figure kb-gallery-item-has-link kadence-blocks-gallery-item-hide-caption kb-has-image-ratio-inherit\"><a href=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH2-mean-value.png\" class=\"kb-gallery-item-link\"><div class=\"kb-gal-image-radius\" style=\"max-width:640px\"><div class=\"kb-gallery-image-contain kadence-blocks-gallery-intrinsic kb-gallery-image-ratio-inherit\" style=\"padding-bottom:75%\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH2-mean-value.png\" width=\"640\" height=\"480\" alt=\"\" data-full-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH2-mean-value.png\" data-light-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH2-mean-value.png\" data-id=\"187\" data-link=\"https:\/\/msenger.web.cern.ch\/?attachment_id=187\" class=\"wp-image-187undefined\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH2-mean-value.png 640w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH2-mean-value-300x225.png 300w\" sizes=\"(max-width: 640px) 100vw, 640px\" \/><\/div><\/div><\/a><\/figure><\/div><\/li><\/ul><\/div>\n\n\n\n<p>The areas with low collected charge are each of the four metallic pads which prevent the laser to reaching the silicon. The cross-shaped region with higher values of collected charge is the active area where the semiconductor is exposed to the light of the laser.<\/p>\n<p>This data was fed into the training algorithm. At each \\( x,y \\) point the algorithm used the 333 samples to produce a set of four \\( f_{Q_i} \\) functions by using a Gaussian KDE approximation. Then, via the interpolation method described in <a href=\"https:\/\/msenger.web.cern.ch\/empirical-likelihood-function-with-continuous-parameters\/\" data-type=\"URL\" data-id=\"https:\/\/msenger.web.cern.ch\/empirical-likelihood-function-with-continuous-parameters\/\">the previous post<\/a>, the distribution functions were extended to the whole \\( x,y \\) region and the &#8220;likelihood function&#8221; was constructed.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">Position reconstruction<\/h2>\n\n\n\n<p>Having the algorithm trained, the reconstruction process is very simple: Just take the &#8220;likelihood function&#8221; \\( \\mathscr{L} \\) and replace \\( Q_i \\) by the observed values for some particle hit, maximize this function in \\( x,y \\) and you obtain the position estimation.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\">Data for position reconstruction evaluation<\/h3>\n\n\n\n<p>To evaluate the performance of the algorithm for position reconstruction I took new data. The data acquisition process was identical to the one for training, but I took it at different \\( x,y \\) points. Below I expose the average collected charge at each point using the data for position reconstruction:<\/p>\n\n\n<style>.wp-block-kadence-advancedgallery .kb-gallery-type-grid.kb-gallery-id-_b93ddd-b5{margin:-5px;}.kb-gallery-type-grid.kb-gallery-id-_b93ddd-b5 .kadence-blocks-gallery-item{padding:5px;}.kb-gallery-id-_b93ddd-b5 .kadence-blocks-gallery-item .kb-gal-image-radius{border-radius:0px 0px 0px 0px;}<\/style>\n<div class=\"wp-block-kadence-advancedgallery kb-gallery-wrap-id-_b93ddd-b5\"><ul class=\"kb-gallery-ul kb-gallery-type-grid kb-gallery-id-_b93ddd-b5 kb-gallery-caption-style-bottom-hover kb-gallery-filter-none kb-gallery-magnific-init\" data-item-selector=\".kadence-blocks-gallery-item\" data-image-filter=\"none\" data-lightbox-caption=\"false\" data-columns-xxl=\"2\" data-columns-xl=\"2\" data-columns-lg=\"2\" data-columns-md=\"2\" data-columns-sm=\"1\" data-columns-xs=\"1\"><li class=\"kadence-blocks-gallery-item\"><div class=\"kadence-blocks-gallery-item-inner\"><figure class=\"kb-gallery-figure kb-gallery-item-has-link kadence-blocks-gallery-item-hide-caption kb-has-image-ratio-inherit\"><a href=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH4-mean-value-1.png\" class=\"kb-gallery-item-link\"><div class=\"kb-gal-image-radius\" style=\"max-width:640px\"><div class=\"kb-gallery-image-contain kadence-blocks-gallery-intrinsic kb-gallery-image-ratio-inherit\" style=\"padding-bottom:75%\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH4-mean-value-1.png\" width=\"640\" height=\"480\" alt=\"\" data-full-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH4-mean-value-1.png\" data-light-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH4-mean-value-1.png\" data-id=\"196\" data-link=\"https:\/\/msenger.web.cern.ch\/?attachment_id=196\" class=\"wp-image-196undefined\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH4-mean-value-1.png 640w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH4-mean-value-1-300x225.png 300w\" sizes=\"(max-width: 640px) 100vw, 640px\" \/><\/div><\/div><\/a><\/figure><\/div><\/li><li class=\"kadence-blocks-gallery-item\"><div class=\"kadence-blocks-gallery-item-inner\"><figure class=\"kb-gallery-figure kb-gallery-item-has-link kadence-blocks-gallery-item-hide-caption kb-has-image-ratio-inherit\"><a href=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH3-mean-value-1.png\" class=\"kb-gallery-item-link\"><div class=\"kb-gal-image-radius\" style=\"max-width:640px\"><div class=\"kb-gallery-image-contain kadence-blocks-gallery-intrinsic kb-gallery-image-ratio-inherit\" style=\"padding-bottom:75%\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH3-mean-value-1.png\" width=\"640\" height=\"480\" alt=\"\" data-full-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH3-mean-value-1.png\" data-light-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH3-mean-value-1.png\" data-id=\"195\" data-link=\"https:\/\/msenger.web.cern.ch\/?attachment_id=195\" class=\"wp-image-195undefined\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH3-mean-value-1.png 640w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH3-mean-value-1-300x225.png 300w\" sizes=\"(max-width: 640px) 100vw, 640px\" \/><\/div><\/div><\/a><\/figure><\/div><\/li><li class=\"kadence-blocks-gallery-item\"><div class=\"kadence-blocks-gallery-item-inner\"><figure class=\"kb-gallery-figure kb-gallery-item-has-link kadence-blocks-gallery-item-hide-caption kb-has-image-ratio-inherit\"><a href=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH1-mean-value-1.png\" class=\"kb-gallery-item-link\"><div class=\"kb-gal-image-radius\" style=\"max-width:640px\"><div class=\"kb-gallery-image-contain kadence-blocks-gallery-intrinsic kb-gallery-image-ratio-inherit\" style=\"padding-bottom:75%\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH1-mean-value-1.png\" width=\"640\" height=\"480\" alt=\"\" data-full-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH1-mean-value-1.png\" data-light-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH1-mean-value-1.png\" data-id=\"193\" data-link=\"https:\/\/msenger.web.cern.ch\/?attachment_id=193\" class=\"wp-image-193undefined\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH1-mean-value-1.png 640w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH1-mean-value-1-300x225.png 300w\" sizes=\"(max-width: 640px) 100vw, 640px\" \/><\/div><\/div><\/a><\/figure><\/div><\/li><li class=\"kadence-blocks-gallery-item\"><div class=\"kadence-blocks-gallery-item-inner\"><figure class=\"kb-gallery-figure kb-gallery-item-has-link kadence-blocks-gallery-item-hide-caption kb-has-image-ratio-inherit\"><a href=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH2-mean-value-1.png\" class=\"kb-gallery-item-link\"><div class=\"kb-gal-image-radius\" style=\"max-width:640px\"><div class=\"kb-gallery-image-contain kadence-blocks-gallery-intrinsic kb-gallery-image-ratio-inherit\" style=\"padding-bottom:75%\"><img loading=\"lazy\" decoding=\"async\" src=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH2-mean-value-1.png\" width=\"640\" height=\"480\" alt=\"\" data-full-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH2-mean-value-1.png\" data-light-image=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH2-mean-value-1.png\" data-id=\"194\" data-link=\"https:\/\/msenger.web.cern.ch\/?attachment_id=194\" class=\"wp-image-194undefined\" srcset=\"https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH2-mean-value-1.png 640w, https:\/\/msenger.web.cern.ch\/wp-content\/uploads\/2021\/01\/Collected-charge-a.u.-CH2-mean-value-1-300x225.png 300w\" sizes=\"(max-width: 640px) 100vw, 640px\" \/><\/div><\/div><\/a><\/figure><\/div><\/li><\/ul><\/div>\n\n\n\n<h3 class=\"wp-block-heading\">Maximization of the &#8220;likelihood function&#8221;<\/h3>\n\n\n\n<p>Although this position reconstruction process is quite simple, and very straightforward using any modern scientific toolkit, the &#8220;likelihood function&#8221; constructed the way I did has one major problem that complicates the task. The function becomes very peaked around its maximum value and quickly drops down to \\( \\equiv 0 \\), making it a flat function along most of the \\( x,y \\) space. This makes the maximization process harder since many algorithms work by doing small variations and observing changes in the objective function, but if the function is constant then there are no changes at all and the maximization fails. Possible solutions to this are<\/p>\n<ul>\n<li>Use a &#8220;brute force&#8221; maximization method which will eventually find the maximum, but it may take longer time to find it.<\/li>\n<li>Redefine the empirical distribution functions \\( f_{Q_i} \\) such that they have small tails that do not contribute to the probability distribution and avoid the &#8220;likelihood function&#8221; to drop down to \\( \\equiv 0 \\).<\/li>\n<\/ul>\n<p>Here I opted for the quick&#8217;n dirty solution, i.e. for a &#8220;brute force&#8221; maximization method to approximately locate the maximum and then feed this into a more sophisticated maximization algorithm to perform a fine search.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\">Some position reconstruction examples<\/h3>\n\n\n\n<p>Here I present some examples of how the algorithm reconstructs the impact position of the TCT&#8217;s laser. Let&#8217;s begin with a beautiful example:<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210114%20first%20results%20on%20position%20resolution%20with%20empirical%20likelihood%20post\/reconstruction_example_1.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>In this plot the color map is the &#8220;likelihood function&#8221; \\( \\mathscr{L} \\), the big white cross shows where the active area is (outside this cross there are the metallic pads), the small light crosses show the points where the training data was acquired, the empty circle is the position of the TCT and the filled circle is the reconstructed position. (Please zoom in to see more details, the plot is interactive, just draw a square around the area you want to zoom in.) There is also a line joining the laser position with the reconstructed position that is the reconstruction error, in this case around 0.93 \u00b5m. As can be seen in this example, the algorithm was capable to provide a reasonable good estimation. In this case, however, the laser was shined exactly in one of the spots that was used for training.<\/p>\n\n\n\n<p>Let&#8217;s see now another example in which the laser was not shined into one of the training points:<\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210114%20first%20results%20on%20position%20resolution%20with%20empirical%20likelihood%20post\/reconstruction_example_2.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>In this case the laser was shined in the middle of four training points. The reconstructed position is, again, quite good. <\/p>\n\n\n\n<p>There are other examples that are not so happy, though. Consider the following two plots:<\/p>\n\n\n\n<div class=\"wp-block-columns is-layout-flex wp-container-core-columns-layout-1 wp-block-columns-is-layout-flex\">\n<div class=\"wp-block-column is-layout-flow wp-block-column-is-layout-flow\">\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210114%20first%20results%20on%20position%20resolution%20with%20empirical%20likelihood%20post\/reconstruction_example_3.html\" width=\"100%\" height=\"555\"><\/iframe>\n<\/div>\n\n\n\n<div class=\"wp-block-column is-layout-flow wp-block-column-is-layout-flow\">\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210114%20first%20results%20on%20position%20resolution%20with%20empirical%20likelihood%20post\/reconstruction_example_4.html\" width=\"100%\" height=\"555\"><\/iframe>\n<\/div>\n<\/div>\n\n\n\n<p>Both of these plots have relatively big reconstruction errors, 11 \u00b5m and 5.5 \u00b5m respectively. Despite both errors are big, their source is clearly different. For the case in the left we can see that the maximization failed, because the reconstructed point is far away from the maximum of \\( \\mathscr{L} \\). So in this case the error is not a problem of the method presented here but from the maximization algorithm, and should, in principle, have some &#8220;easy solution&#8221;. For the plot in the right we see that there was no maximization problem, but the maximum of \\( \\mathscr{L} \\) is indeed far away from the position where the laser was shined. I still don&#8217;t know why this happens.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\">First estimations of position resolution<\/h2>\n\n\n\n<p>Using this data I have already done some first estimations on the position resolution. In the plot below I show the distribution for the reconstruction error at a single \\( xy \\) point (see below the plot with the point indicated). <\/p>\n\n\n\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210114%20first%20results%20on%20position%20resolution%20with%20empirical%20likelihood%20post\/Reconstructed%20point%20distribution%20for%20nx%20%3D%203%2C%20ny%20%3D%204.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p>In this histogram we see a peaked distribution around 550 nm with a width of the order of 1 \u00b5m (please zoom in the plot), which I believe (without an in-depth analysis\/thinking yet) can be considered as the spacial resolution of the system <em>detector+reconstruction algorithm<\/em>. It is also possible to see many bins at random positions &gt; 7 \u00b5m with one, two or 3 entries. These are, probably, due to errors in the maximization algorithm of the likelihood function.<\/p>\n\n\n\n<p>The plots below are two reconstruction examples from this data set. In the left we see a &#8220;good example&#8221; while in the right there is one in which the maximization of the &#8220;likelihood function&#8221; failed.<\/p>\n\n\n\n<div class=\"wp-block-columns is-layout-flex wp-container-core-columns-layout-2 wp-block-columns-is-layout-flex\">\n<div class=\"wp-block-column is-layout-flow wp-block-column-is-layout-flow\">\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210114%20first%20results%20on%20position%20resolution%20with%20empirical%20likelihood%20post\/reconstruction_example_6.html\" width=\"100%\" height=\"555\"><\/iframe>\n<\/div>\n\n\n\n<div class=\"wp-block-column is-layout-flow wp-block-column-is-layout-flow\">\n<iframe loading=\"lazy\" src=\"https:\/\/htmlpreview.github.io\/?https:\/\/github.com\/SengerM\/html-github-hosting\/blob\/main\/210114%20first%20results%20on%20position%20resolution%20with%20empirical%20likelihood%20post\/reconstruction_example_5.html\" width=\"100%\" height=\"555\"><\/iframe>\n\n\n\n<p><\/p>\n<\/div>\n<\/div>\n\n\n\n<h2 class=\"wp-block-heading\">Conclusion<\/h2>\n\n\n\n<p>The &#8220;empirical likelihood function method&#8221; from my previous post was successfully applied for the first time to the reconstruction of the impact position of the TCT&#8217;s laser in an AC-LGAD. The method is working and yielding good results, at least for a first test of concept implementation. There are some points to work on in order to improve results which were already identified, such as do some pre-processing of the data before feeding it into the reconstruction algorithm, improving the maximization of the &#8220;likelihood function&#8221; and trying to implement the actual likelihood function taking into account that variables are not independent. Furthermore, more variables can be added to the likelihood function to increase its power, such as the amplitude, the arrival time and the time over threshold, which are quantities that demonstrated to have interesting dependence with the position.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>During the last days I was working on the application of the maximum &#8220;empirical likelihood&#8221; estimator for the hit position of a particle in an AC-LGAD. To get an introduction to this method, please have a look at this previous post. Today I am going to write about how I am applying this method to &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"\" href=\"https:\/\/msenger.web.cern.ch\/first-application-of-the-empirical-likelihood-function-to-position-reconstruction-in-ac-lgad-detectors\/\"> <span class=\"screen-reader-text\">First application of the empirical likelihood function to position reconstruction in AC-LGAD detectors<\/span> Read More &raquo;<\/a><\/p>\n","protected":false},"author":1,"featured_media":188,"comment_status":"closed","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"inline_featured_image":false,"footnotes":""},"categories":[1],"tags":[7,24,5],"_links":{"self":[{"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/posts\/176"}],"collection":[{"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/comments?post=176"}],"version-history":[{"count":32,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/posts\/176\/revisions"}],"predecessor-version":[{"id":687,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/posts\/176\/revisions\/687"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/media\/188"}],"wp:attachment":[{"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/media?parent=176"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/categories?post=176"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/msenger.web.cern.ch\/wp-json\/wp\/v2\/tags?post=176"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}